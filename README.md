<picture>
  <source media="(prefers-color-scheme: dark)" srcset="https://www.codelabx.ltd/assets/images/xtend-packages/rest-presenter/rest-presenter-banner-dark.png">
  <img alt="XtendLaravel" src="https://www.codelabx.ltd/assets/images/xtend-packages/rest-presenter/rest-presenter-banner-light.png">
</picture>

[![Latest Version on Packagist](https://img.shields.io/packagist/v/xtend-packages/rest-presenter.svg?style=flat-square)](https://packagist.org/packages/xtend-packages/rest-presenter)
[![PHP from Packagist](https://img.shields.io/packagist/php-v/xtend-packages/rest-presenter)](https://packagist.org/packages/xtend-packages/rest-presenter)
[![GitHub License](https://img.shields.io/github/license/xtend-packages/rest-presenter)](https://github.com/xtend-packages/rest-presenter/blob/main/LICENSE.md)
[![GitHub Tests Action Status](https://img.shields.io/github/actions/workflow/status/xtend-packages/rest-presenter/tests.yml?label=tests)](https://github.com/xtend-packages/rest-presenter/actions/workflows/tests.yml)
[![GitHub Code Style Action Status](https://img.shields.io/github/actions/workflow/status/xtend-packages/rest-presenter/code-styling.yml?label=code%20style)](https://github.com/xtend-packages/rest-presenter/actions/workflows/code-styling.yml)
[![GitHub Code Style Action Status](https://img.shields.io/github/actions/workflow/status/xtend-packages/rest-presenter/phpstan.yml?label=static%20analysis)](https://github.com/xtend-packages/rest-presenter/actions/workflows/phpstan.yml)
[![Total Downloads](https://img.shields.io/packagist/dt/xtend-packages/rest-presenter.svg?style=flat-square)](https://packagist.org/packages/xtend-packages/rest-presenter)
[![Discord](https://img.shields.io/discord/1033138523584331837?label=Discord&logo=discord)](https://discord.gg/j7EAhVVcyX)

# RESTPresenter

RESTPresenter simplifies Laravel API development by providing a lightweight package that seamlessly integrates with Laravel API Resources and Spatie's powerful Data objects.

## Filament Quick Start
You can now use RESTPresenter to generate your API collection directly from any Filament project.\
Please follow the steps below to get started:

Install package ("minimum-stability": "dev", may be required in your composer.json file):
```bash
composer require xtend-packages/rest-presenter
````
Run the direct setup command for our Filament starter kit to avoid prompts:
```bash
php artisan rest-presenter:setup --starter-kit=Filament
```
To generate your API collection, run the following command below:
```bash
php artisan rest-presenter:generate-api-collection
```
Postman collection generated by default. We also support Insomnia simply by setting the following in your .env file:
```bash
REST_PRESENTER_EXPORT_PROVIDER=insomnia
```

### The following directories with generated files will be created:
- `app/Api/StarterKits/Filament` (contains all generated resources)
- `resources/rest-presenter/postman` (generated Postman collection)
- `resources/rest-presenter/insomnia` (generated Insomnia collection)
- `resources/types/` (generated TypeScript DTOs)
- `tests/StarterKits/Filament` (generated tests)

> **_WARNING:_** Please don't run any tests before you update your phpunit.xml file to include the following:

```xml 
<env name="DB_CONNECTION" value="sqlite"/>
<env name="DB_DATABASE" value=":memory:"/>
```

Without this update, it will use your default database connection and refresh the database after each test.

### API Collection Auto-Generation
Make sure you only run this command after the setup command to generate your API collection.

```bash
php artisan rest-presenter:generate-api-collection
```

RESTPresenter generates a Postman collection by default.\
To generate an Insomnia collection, set the following in your .env file:
```bash
REST_PRESENTER_EXPORT_PROVIDER=insomnia
```

### Security API Key
Be default RESTPresenter provides a security API key for your API collection.\
The default key is value is `rest-presenter-secret-key`

Please note that the API key is only for local development and should not be used in production.
You can change the API by setting the following in your .env file:
```bash
REST_PRESENTER_AUTH_API_KEY=your-new-secret-key
```
Additionally to opt out of using this feature, set the following in your .env file:
```bash
REST_PRESENTER_AUTH_ENABLE_API_KEY=false
```

### Authentication
RESTPresenter currently provides a simple authentication middleware for your API collection.\
Simply set `public static bool $isAuthenticated = true;` in any resource to use your bearer token for authentication to access the resource.

## Starter Kits
Our initial release includes the following Starter Kits to jumpstart your development:
- [Sanctum Auth Starter Kit](https://github.com/xtend-packages/rest-presenter/discussions/categories/general)
- [Filament API Starter Kit](https://github.com/xtend-packages/rest-presenter/discussions/categories/filament-starter-kit)

## Key Features

- Effortless REST API creation with Laravel API Resources.
- Simplified data transformation using our Presenter layer.
- Built-in example filters and presenters for rapid API development.
- Testing support to ensure reliability and stability.
- Automating API creation from resources in Filament.
- TypeScript auto-generation for API resource DTOs.
- Postman and Insomnia collection generation for easy API testing.
- Secure your API collection with a security API key.
- Simple authentication middleware for your API resources.

## Planned Features
- Release of Sponsorware API Kits for comprehensive API integration.
- Customisable kits providing a solid foundation for API development.
- Future open-sourcing of full kits upon reaching sponsorship milestones.
- Widget API generation for easy integration with your frontend.
- Social Kit for login and registration with social media platforms.

Check out our [Roadmap](https://github.com/orgs/xtend-packages/projects/1/views/1) for upcoming features and improvements. Feel free to open an issue for suggestions or feature requests. Join us on Discord to start a discussion and stay updated on the latest news.\

[![Discord](https://img.shields.io/discord/1033138523584331837?label=Discord&logo=discord)](https://discord.gg/j7EAhVVcyX)

## What Makes This Package Unique?
RESTPresenter is more than just a CRUD generator. It offers:
- A Presenter layer for easy data transformation without modifying API resources.
- Compliance with standard features like OpenAPI, RESTful CRUD, filtering/pagination.
- Better business logic and direct access to required data for requests.
- Everything is extendable and customisable to fit your project's needs.
- API Kits to jumpstart your development with pre-built features and resources.

## Requirements

- PHP ^8.2
- Laravel 10+

## Installation

You can install the package via composer:

```bash
composer require xtend-packages/rest-presenter
```
Please note: if you receive an error during installing this package, you may need to update your minimum stability requirement to dev in your composer.json file:

```bash
"minimum-stability": "dev",
```

## Setup
Customize RESTPresenter for your project with our setup command:

```bash
php artisan rest-presenter:setup
```
Select the Starter Kits to use during setup to configure the package according to your needs. The command also publishes the configuration file rest-presenter.php to your config directory and automatically registers the RESTPresenterServiceProvider.

## So What Are Presenters?
Presenters are simply a way to transform data before it's sent to the client. They allow you to modify the data in any way you want, without modifying the API resources. This is especially useful when you need to transform data in a specific way for a particular endpoint before sending it to the client.

To use a presenter, simply add the header property `X-REST-PRESENTER: PresenterName` to your request. RESTPresenter will automatically apply the presenter to the data before sending it to the client.
Presenters can be used with collections and single resources. They can also be used with nested resources, allowing you to transform data at any level of the response.

## Usage

### Generate Resources (Prompts)
To generate a new resource, use the following command:

```bash
php artisan rest-presenter:make-resource
```
This command will guide you through creating a new resource. Prompts will allow you to automatically generate presenters, filters, data, and set up your resource ready to use. All model relationships and fields are automatically detected throughout the prompt process. Additionally, we provide a custom option for most prompts to generate without auto-detection.

### Generate Resources (Blueprint)
Coming soon, leveraging the outstanding capabilities of [Laravel Blueprint](https://blueprint.laravelshift.com/)

### Configuration

Configure RESTPresenter in the `config/rest-presenter.php` file to customize the package according to your project requirements.

## Testing

RESTPresenter includes a comprehensive testing suite to ensure your API's reliability and stability. Test generators will soon be added to facilitate testing when creating new resources.

## Contributing

See [CONTRIBUTING](CONTRIBUTING) for details on how to contribute to RESTPresenter.

## License

RESTPresenter is open-source software licensed under the [MIT License](LICENSE)
